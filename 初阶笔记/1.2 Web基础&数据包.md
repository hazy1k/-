# 第1章第2节 Web基础&数据包

## 1.2.1 网站搭建前置知识

    域名，子域名，DNS，HTTP/HTTPS，证书等

### 1.2.1.1 域名

    域名是互联网上用于标识和定位网站的名称。它是由一串用点分隔的字符组成，例如："[example.com](http://example.com/)"。域名的结构通常分为几个部分：

1. 顶级域（Top-Level Domain, TLD）：顶级域位于域名的最右边部分，例如".com"、".net"、".org"等。顶级域通常表示域名的类别或国家/地区。

2. 二级域（Second-Level Domain）：二级域名是紧跟在顶级域名之后的部分，如"example"在"[example.com](http://example.com/)"中就是二级域名。它通常用来标识特定的组织、企业或个人。

3. 子域名（Subdomain）：子域名位于主域名之前，通常用于将网站划分为不同的部分或区域，例如"[blog.example.com](http://blog.example.com/)"中的"blog"就是一个子域名。

    域名的作用是提供了用户友好的方式来访问互联网上的资源，避免了直接使用 IP 地址（例如 192.0.2.1）来访问网站的复杂性。当用户在浏览器中输入一个域名时，浏览器会通过域名系统（DNS）将域名转换为相应的 IP 地址，然后找到并加载对应的网页或其他资源。

    注册域名需要通过注册商进行，注册商是经过授权能够注册和管理域名的组织。通常注册一个域名需要支付一定的费用，并且需要定期续费以保持域名的所有权和有效性。

### 1.2.1.2 DNS

    DNS（Domain Name System）是互联网中用于将域名转换为对应 IP 地址的系统。它充当了互联网上的“电话簿”，使得用户可以通过易记的域名来访问网站，而不必记住复杂的 IP 地址。

DNS 的主要功能包括：

1. 域名解析：DNS 将用户输入的域名转换为对应的 IP 地址。当用户在浏览器中输入一个域名时，浏览器会向本地 DNS 服务器发送查询请求，本地 DNS 服务器然后逐级向上查询直至找到域名对应的 IP 地址，然后将结果返回给浏览器，使浏览器能够连接到相应的服务器。

2. 负载均衡：DNS 可以通过返回不同的 IP 地址来实现负载均衡。例如，一个域名可能对应多个服务器，DNS 可以将不同的请求分发给这些服务器，从而分散服务器的负载，提高网站的性能和可靠性。

3. 域名管理：DNS 允许域名所有者管理其域名的解析记录。通过 DNS 控制面板，域名所有者可以添加、修改和删除域名的解析记录，从而控制域名的指向和配置。

4. 缓存：DNS 服务器通常会缓存已解析的域名和对应的 IP 地址，以提高查询速度和降低网络流量。这样，当多个用户查询相同的域名时，DNS 服务器可以直接返回缓存中的结果，而无需再次查询。

### 1.2.1.3 HTTP/HTTPS

    HTTP（Hypertext Transfer Protocol）和HTTPS（Hypertext Transfer Protocol Secure）是用于在网络上传输数据的协议。它们是客户端（例如浏览器）和服务器之间进行通信的基础。

1. HTTP：HTTP是一种用于传输超文本数据的应用层协议。它是互联网上最常用的协议之一，用于从服务器传输网页、图片、视频、音频等资源到客户端（通常是浏览器）。HTTP的工作方式是通过请求-响应模型，客户端发送HTTP请求到服务器，服务器处理请求并返回相应的HTTP响应。

2. HTTPS：HTTPS是HTTP的安全版本，通过使用TLS/SSL加密传输数据，提供了更安全的通信方式。在HTTPS中，客户端和服务器之间的数据传输是加密的，这意味着即使被截获，也很难窃取或篡改数据。HTTPS通常用于处理敏感信息，如个人信息、信用卡信息等。网站使用HTTPS可以通过获取和安装SSL/TLS证书来实现。

    HTTPS相比HTTP的优势包括：

- 安全性：HTTPS提供了加密传输，可以保护用户数据的隐私和安全。
- 身份验证：HTTPS使用SSL/TLS证书对服务器进行身份验证，确保客户端与正确的服务器进行通信，防止中间人攻击。
- 搜索引擎排名：搜索引擎通常会将采用HTTPS的网站排名更高，因为HTTPS被认为是更安全和更可信的通信方式。

### 1.2.1.4 证书

    SSL/TLS证书是用于在HTTPS连接中实现加密和身份验证的重要组成部分。这些证书是由称为证书颁发机构（Certificate Authorities，CA）的可信任实体签发的，并包含了与特定域名相关联的公钥以及相关的信息。

SSL/TLS证书的作用包括：

1. 加密通信：SSL/TLS证书用于加密客户端和服务器之间的通信，以确保数据在传输过程中不被窃取或篡改。这种加密技术可以防止中间人攻击和窃听。

2. 身份验证：SSL/TLS证书还用于验证服务器的身份。当客户端与服务器建立连接时，服务器会向客户端发送其SSL/TLS证书，客户端可以验证证书的有效性，并确保其与要访问的域名匹配。这可以防止恶意的伪装或欺骗。

3. 建立信任：通过使用SSL/TLS证书，网站可以建立信任关系，并向用户展示其身份已经得到认证，从而增加用户对网站的信任度。

    SSL/TLS证书通常包含以下信息：

- 域名：证书是与特定域名相关联的，确保服务器是与用户期望通信的正确服务器。
- 公钥：证书包含一个公钥，用于加密通信中的数据。
- 颁发机构信息：证书还包含颁发该证书的证书颁发机构（CA）的信息，以及证书的有效期等。

## 1.2.2 Web应用环境架构分类

- 开发语言：asp、php、aspx、jsp、java、python、ruby、htm、js等

- 程序源码：根据开发语言分类；应用类型分类；开源CMS分类；开发框架分类等

- 中间体容器：IIS、Apache、Nginx等

- 数据库类型：Access、Mysql、Mssql等

- 操作系统：Windows、Linux、Mac等

- 第三方软件：phpmyadmin、vs-ftpd、VNC等

## 1.2.3 Web应用安全漏洞分类

    SQL注入，文件安全，RCE执行，XSS跨站，CSRF\SSRF\CRLF，反序列化。逻辑越权，未授权访问，XXE\XML，弱口令安全等

## 1.2.4 Web请求、返回数据包

    请先了解一下Web请求和数据包结构，不然本节案例看不懂的啊

    参考：[HTTP协议 9 种请求方式用途及区别（详解）-- GET、POST、HEAD、OPTIONS、PUT、PATCH、DELETE、TRACE、CONNECT_get post options-CSDN博客](https://blog.csdn.net/demo_yo/article/details/123596028)[HTTP数据包详解 - dream_fly_info - 博客园 (cnblogs.com)](https://www.cnblogs.com/larry-luo/p/10983845.html)

## 1.2.5 演示案例

### 1.2.5.1 架构-Web应用搭建-域名源码解析

- 云服务器

- 域名解析

- 宝塔一键部署

- 绑定域名

### 1.2.5.2 请求包-新闻回帖点赞-重放数据包

- 打开一个新闻网站，发现里面有点赞功能 

![](https://img.picgo.net/2024/05/25/-2024-05-25-195016b242ede65abd0ffb.png)

- 当我们点了一下赞，就会发现点赞只能点一次

![](https://img.picgo.net/2024/05/25/-2024-05-25-195226243cb379c0b18104.png)

- 但是真的不能再点了吗-这时候我们就需要重发数据包-可以看到我们在网页上操作会发送数据包给对方服务器

<img src="https://img.picgo.net/2024/05/25/-2024-05-25-195542cd1246dc9921abaa.png" title="" alt="" width="812">

- 抓包登场-模拟点赞

<img src="https://img.picgo.net/2024/05/25/-2024-05-25-200256c39aa83300a6a07f.png" title="" alt="" width="842">

- 不断重新发这个点赞成功的数据包-就可以实现刷赞了

<img src="https://img.picgo.net/2024/05/25/-2024-05-25-2003489d5899b1478bbb49.png" title="" alt="" width="899">

![](https://img.picgo.net/2024/05/25/-2024-05-25-200458f64411f494127544.png)

### 1.2.5.3 请求包-移动端&PC访问-自定义UA头

- 打开一个安卓模拟器-看一看与电脑访问有什么不一样-UA头即浏览器信息

PC访问：

<img src="https://img.picgo.net/2024/05/25/-2024-05-25-2011590200ec13f32484d2.png" title="" alt="" width="748">

模拟器：

<img src="https://img.picgo.net/2024/05/25/-2024-05-25-201454899f2b6b5ff636fa.png" title="" alt="" width="781">

- 再通过抓包软件把UA头改成手机的-就相当于浏览手机页面了

<img src="https://img.picgo.net/2024/05/25/-2024-05-25-2031573900236cb78ebec3.png" title="" alt="" width="800">

### 1.2.5.4 返回包-网站文件目录扫描-返回状态码

- 有时候我们需要通过访问目标网站抓包、从而得到信息。比如：访问网站上的一张图片

<img src="https://img.picgo.net/2024/05/25/-2024-05-25-2044586810684fc398c25e.png" title="" alt="" width="870">

- 可以根据对方服务器访问的状态码来判断文件存不存在

![](https://img.picgo.net/2024/05/25/-2024-05-25-204646f3e48e913056479d.png)

### 1.2.5.5 数据包-WAF文件目录扫描-代理服务器

- 上一个案例就是教我们怎么目录扫描看文件存在，但是同一个ip访问网站过快，就会被拉黑ip，这时候我们就需要代理服务器-切换我们的ip

![](https://img.picgo.net/2024/05/27/-2024-05-27-1301057f2f6218201adb39.png)

- 那么我们设置代理后，IP就会变

![](https://img.picgo.net/2024/05/27/-2024-05-27-13035207c428bfc99fc8e3.png)
