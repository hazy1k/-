# 1.4 加密&编码&参数值

## 1.4.1 了解加密编码机制在安全测试中的存在

    加密编码机制在安全测试中的存在是为了评估系统或应用程序的安全性，以确保其在面对恶意攻击时能够有效地保护数据和信息。通过对加密编码机制进行测试，可以发现潜在的安全漏洞和弱点，从而及时采取措施加固系统的安全性。

## 1.4.2 掌握常见的加密解密编码解码进制互转操作

    密码存储加密：MD5 SHA1 NTLM AES DES RC4

- MD5 值是 32 或 16 位位由数字"0-9"和字母"a-f"所组成的字符串

- SHA1 这种加密的密文特征跟 MD5 差不多，只不过位数是 40

- NTLM 这种加密是 Windows 的哈希密码，标准通讯安全协议

- AES,DES,RC4 这些都是非对称性加密算法，引入密钥，密文特征与 Base64 类似

    应用场景：各类应用密文，自定义算法，代码分析，CTF安全比赛等

---

    传输数据编码：BASE64 URL HEX ASCII

- BASE64 值是由数字"0-9"和字母"a-f"所组成的字符串,大小写敏感,结尾通常有符号=

- URL 编码是由数字"0-9"和字母"a-f"所组成的字符串,大小写敏感,通常以%数字字母间隔

- HEX 编码是计算机中数据的一种表示方法,将数据进行十六进制转换,它由 0-9,A-F,组成

- ASCII 编码是将 128 个字符进行进制数来表示,常见 ASCII 码表大小规则：0~9<A~Z<a~z

    举例：

    个人博客-URL解码
    国外某个WEB-BASE64解码
    搜狐视频-BASE64解码
    应用场景：参数传递（如注入影响），后期WAF绕过干扰写法应用，视频地址还原等（爬虫）

---

    JS前端代码加密：J颜文字 jother JSFUCK

- 颜文字特征：一堆颜文字构成的js代码，在F12中可直接解密执行

- jother特征：只用！+( ) [ ] { }这八个字符就能完成对任意字符串的编码。也可在F12中解密执行

- JSFUCK特征：与jother很像，只是少了{ }

---

    后端代码加密：PHP .NET JAVA

- PHP：乱码，头部有信息

- .NET：DLL封装代码文件

- JAVA：JAR&CLASS文件

    举例：Zend ILSpy IDEA
    应用场景：版权代码加密，开发特性，CTF比赛等

## 1.4.3 了解常见的加密解密编码解密进制互转的影响

1. 数据安全性：掌握加密解密技术可以帮助个人和组织确保敏感数据在传输和存储过程中的安全，防止信息被未经授权的访问或篡改。

2. 隐私保护：加密解密技术有助于保护个人隐私信息，例如在网上购物时使用加密的支付方式，或者通过加密电子邮件来保护通信内容的隐私。

3. 合规性和法律要求：许多行业和政府标准要求对敏感数据进行加密处理，因此了解加密解密技术对于遵守这些合规性要求至关重要。

4. 安全通信：加密技术对于确保安全的通信渠道至关重要，尤其是在远程办公和远程团队协作的情况下，加密通信可以有效地防范数据泄露和窃听。

5. 安全测试和漏洞挖掘：熟悉加密解密机制使安全专业人员能够更好地评估系统的安全性，并发现潜在的安全漏洞和弱点。

6. 数字货币和区块链技术：对加密解密技术的了解对于理解数字货币和区块链技术的工作原理至关重要，这些技术在金融和数据交换领域发挥着越来越重要的作用。

## 1.4.4 识别算法编码类型

1. 看密文位数

2. 看密文的特征（数字、字母、大小写、符号等）

3. 看当前密文存在的地方（Web、数据库、操作系统等应用）

分析密文特征和加解密更多可以参考：[30余种加密编码类型的密文特征分析（建议收藏） (qq.com)](https://mp.weixin.qq.com/s?__biz=MzAwNDcxMjI2MA==&mid=2247484455&idx=1&sn=e1b4324ddcf7d6123be30d9a5613e17b&chksm=9b26f60cac517f1a920cf3b73b3212a645aeef78882c47957b9f3c2135cb7ce051c73fe77bb2&mpshare=1&scene=23&srcid=1111auAYWmr1N0NAs9Wp2hGz&sharer_sharetime=1605145141579&sharer_shareid=5051b3eddbbe2cb698aedf9452370026#rd)

[CTF密码学常见加密解密总结_wydfxjmgvswodododod-CSDN博客](https://blog.csdn.net/qq_40837276/article/details/83080460)

[CTF中常见密码题解密网站总结_ctf解密网站-CSDN博客](https://blog.csdn.net/qq_41638851/article/details/100526839)

## 工具网站

[md5在线解密破解,md5解密加密 (cmd5.com)](https://www.cmd5.com/)

[JSFuck - Write any JavaScript with 6 Characters: []()!+](https://jsfuck.com/)

[CTF在线工具-CTF工具|CTF编码|CTF密码学|CTF加解密|程序员工具|在线编解码 (hiencode.com)](http://www.hiencode.com/)

[在线AES加密解密、AES在线加密解密、AES encryption and decryption--查错网 (chacuo.net)](http://tool.chacuo.net/cryptaes)

## 1.4.5 演示案例

### 1.4.5.1 Web-ZZCMS-密文-MD5

- 先把网站（ZZCMS）搭建起来，看一下网站是怎么存储用户账号密码的（找到数据库存储用户账密的表单）

![屏幕截图 2024 06 08 170935](https://img.picgo.net/2024/06/08/-2024-06-08-170935a29ad6f72034dbf8.png)

- 此时我们再在网站上面注册一个用户，看一下会发生什么

![屏幕截图 2024 06 08 171213](https://img.picgo.net/2024/06/08/-2024-06-08-17121306a65d047209220e.png)

    可以看到已经有新用户的信息了，但是注意观察，密码是有加密的（MD5），通过特征我们判断这是使用了MD5加密。

    在以后的攻防，我们可能会得到管理员的账号密码，肯定是加密的，所以我们需要分析。

### 1.4.5.2 Web-Discuz-密文-MD5&Salt

- 不同网站加密发生可能会不同，我们需要多种分析方法，举例：Discuz

![屏幕截图 2024 06 08 172650](https://img.picgo.net/2024/06/08/-2024-06-08-1726500b00700060529c1b.png)

- 这个时候我们就发现，这个网站的密码存储表单多了一个叫（salt）的东西 所以我们再解密的时候要加上这个值-盐

![屏幕截图 2024 06 08 172805](https://img.picgo.net/2024/06/08/-2024-06-08-17280522b549d95562ff60.png)

    相比于单纯的MD5，这里使用了MD5+salt的加密方式

### 1.4.5.3 系统-Windows-密文-NTLM&HASH

- 启动windows系统的虚拟机，使用mimikatz这个工具可以查看系统的密码之类的

![屏幕截图 2024 06 08 190247](https://img.picgo.net/2024/06/08/-2024-06-08-19024765818e35e64a552c.png)

- 我们可以观察到管理员密码用到了NTLM加密

![屏幕截图 2024 06 08 190747](https://img.picgo.net/2024/06/08/-2024-06-08-190747093b3c1bb0460980.png)

### 1.4.5.4 综合-参数-密文传输-AES&BASE64

- 但是往往解密不会这么容易，会要求其他信息才能进行解密或者不可逆，比如AES加密就有7个待选项

![屏幕截图 2024 06 08 191448](https://img.picgo.net/2024/06/08/-2024-06-08-191448c15a567bad8c8b00.png)

- 靶机试验（AES）启动靶机，要求我们找密码，我们可以看到网站url有明显的BASE64或者AES加密特征，于是尝试解密

![屏幕截图 2024 06 08 191954](https://img.picgo.net/2024/06/08/-2024-06-08-1919542913823d9b2d8361.png)

- 靶场提示了加密过程（不提示的话，自己解密很难的-基本上不可能）

![屏幕截图 2024 06 08 192312](https://img.picgo.net/2024/06/08/-2024-06-08-192312bb4dd15c180fb8ba.png)

- 根据提示开始解密，结果就出来了

![屏幕截图 2024 06 08 192718](https://img.picgo.net/2024/06/08/-2024-06-08-1927182d659bbf83172312.png)

### 1.4.5.5 代码-解密-解密反编译-Zend&Dll&Jar

- 软件公司或者个人发行了一个程序，受到欢迎，很多人购买，这个时候为了保护版权，就会对代码加密，这个时候我们就想要反编译

![屏幕截图 2024 06 09 160832](https://img.picgo.net/2024/06/09/-2024-06-09-1608329fc568f92353040d.png)

    可以看到这个PHP代码肯定是被加密了（头部有信息-Zend）

- 我们尝试解密

![屏幕截图 2024 06 09 161127](https://img.picgo.net/2024/06/09/-2024-06-09-16112768bae0613d88474c.png)

- 打开解密后的文件-可以看到源码已经显示出来了呀

![屏幕截图 2024 06 09 161240](https://img.picgo.net/2024/06/09/-2024-06-09-16124079040d938534f6a6.png)

### 1.4.5.6 CTF赛题-buuoj-single-JS颜文字

- CTF有一道考题，给了一张图片，提示用了隐写，我们先把隐写的文件找出来

![屏幕截图 2024 06 09 163952](https://img.picgo.net/2024/06/09/-2024-06-09-163952ff9286ef7a02c668.png)

- 打开隐写下面的文件，是一个txt文本里面的内容使用了加密

![屏幕截图 2024 06 09 164215](https://img.picgo.net/2024/06/09/-2024-06-09-164215eb2eec5dc8467c55.png)

- 既然有加密就有解密-使用CTF网站上的解密工具-很快就解密出来了

![屏幕截图 2024 06 09 164452](https://img.picgo.net/2024/06/09/-2024-06-09-164452cd8b67dc6729284d.png)

## 1.4.5.7 CTF赛题-xuenixiang-Jsfuck

- 同样是一道CTF考题

![屏幕截图 2024 06 09 161127](https://img.picgo.net/2024/06/09/-2024-06-09-16112768bae0613d88474c.png)

- 下载文件，要我们找flag，查看源代码内容是加密的 

![屏幕截图 2024 06 09 165112](https://img.picgo.net/2024/06/09/-2024-06-09-165112c9ac847a5f1e261d.png)

![屏幕截图 2024 06 09 165212](https://img.picgo.net/2024/06/09/-2024-06-09-165212436c4be5ff102c90.png)

- 我们再拿到网站上解密，密文就出来了

![屏幕截图 2024 06 09 165407](https://img.picgo.net/2024/06/09/-2024-06-09-165407b0325c50c8c29d91.png)
